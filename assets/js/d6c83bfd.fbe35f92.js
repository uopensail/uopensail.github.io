"use strict";(self.webpackChunkuopensail_github_io=self.webpackChunkuopensail_github_io||[]).push([[4677],{281:e=>{e.exports=JSON.parse('{"permalink":"/blog/AppS/OneEpochInRecAlgo","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/AppS/OneEpochInRecAlgo.md","source":"@site/blog/AppS/OneEpochInRecAlgo.md","title":"The One Epoch Phenomenon in Recommendation Algorithms","description":"In the field of Click-Through Rate (CTR) prediction and recommendation systems, the \\"ONE EPOCH phenomenon\\" refers to the overfitting phenomenon where deep models achieve optimal generalization performance after only one epoch of training, and continued training leads to a sharp decline in performance on the test set.","date":"2025-03-22T08:54:54.000Z","tags":[],"readingTime":2.315,"hasTruncateMarker":false,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"Application of the MMOE Model in AppS","permalink":"/blog/AppS/MMOE"},"nextItem":{"title":"Applicaton Store(AppS) Introduction","permalink":"/blog/AppS/intro"}}')},1902:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var i=t(281),r=t(4848),s=t(8453);const a={},o="The One Epoch Phenomenon in Recommendation Algorithms",l={authorsImageUrls:[]},c=[{value:"Phenomenon Characteristics",id:"phenomenon-characteristics",level:2},{value:"Key Causes",id:"key-causes",level:2},{value:"Mitigation Strategies",id:"mitigation-strategies",level:2},{value:"Insights from Industrial Practice",id:"insights-from-industrial-practice",level:2},{value:"Theoretical Hypotheses",id:"theoretical-hypotheses",level:2},{value:"Further Reading",id:"further-reading",level:2}];function h(e){const n={a:"a",center:"center",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:'In the field of Click-Through Rate (CTR) prediction and recommendation systems, the "ONE EPOCH phenomenon" refers to the overfitting phenomenon where deep models achieve optimal generalization performance after only one epoch of training, and continued training leads to a sharp decline in performance on the test set.'}),"\n",(0,r.jsx)(n.h2,{id:"phenomenon-characteristics",children:"Phenomenon Characteristics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Performance During Training\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The model reaches a peak AUC on the test set at the end of the first epoch, and performance rapidly declines after the start of the second epoch.\nOverfitting manifests as a continuous decrease in training loss, but validation set metrics (such as AUC) significantly deteriorate after one epoch."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Relevance to Industrial Practice\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This phenomenon explains why many industrial-grade recommendation systems stop training after only one epoch of data, rather than following the multiple iterations typical of traditional deep learning."}),"\n",(0,r.jsxs)(n.center,{children:["\n",(0,r.jsx)(n.img,{title:"",src:"../../static/images/one-epoch-1.png",alt:"",width:"268","data-align":"center"}),"\n",(0,r.jsx)(n.img,{title:"",src:"../../static/images/one-epoch-2.png",alt:"",width:"261","data-align":"center"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"key-causes",children:"Key Causes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Feature Sparsity\u200c"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"The high number of IDs in feature domains"})," (such as user IDs, product IDs) results in extremely low frequencies of occurrence for each ID, making the model prone to memorizing sparse samples rather than generalizing.\nThe Embedding layer corresponding to sparse features overfits low-frequency IDs during multiple training epochs."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Model Optimization Characteristics\u200c"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Strong optimizers (such as Adam) and larger learning rates"})," accelerate convergence, enabling the model to complete effective learning within one epoch, with subsequent training falling into local overfitting.\nComplex model structures (such as deep networks) with excessive capacity exacerbate the memorization of noise/sparse features."]}),"\n",(0,r.jsx)(n.h2,{id:"mitigation-strategies",children:"Mitigation Strategies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Feature Engineering Optimization\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Reduce Sparsity\u200c: Merge low-frequency IDs, use default values to replace sparse IDs, reduce hash space.\nDynamic Feature Filtering\u200c: Dynamically adjust the participation intensity of sparse features based on the training stage."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Training Parameter Adjustment\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Limit Training Epochs\u200c: Force training to stop after only one epoch.\nLearning Rate Control\u200c: Use a smaller initial learning rate or a learning rate decay strategy."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Model Structure Improvement\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Simplify the Embedding layer or introduce regularization (such as Dropout) to suppress overfitting."}),"\n",(0,r.jsx)(n.h2,{id:"insights-from-industrial-practice",children:"Insights from Industrial Practice"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Strong Correlation with Data Distribution\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This phenomenon is particularly significant in high-sparsity business scenarios (such as advertising recommendations, e-commerce CTR prediction), but rarely occurs in dense data tasks."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Priority of Optimization Directions\u200c"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The industrial community tends to directly avoid the problem through feature engineering and early stopping strategies, rather than modifying the model structure."}),"\n",(0,r.jsx)(n.h2,{id:"theoretical-hypotheses",children:"Theoretical Hypotheses"}),"\n",(0,r.jsx)(n.p,{children:"Some studies suggest that the ONE EPOCH phenomenon may stem from the dynamic balance between sample memorization and generalization: in the first epoch, the model completes coarse-grained learning of key features, and subsequent training disrupts generalization ability due to over-refinement of local features."}),"\n",(0,r.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://arxiv.org/pdf/2209.06053",children:"Towards Understanding the Overfitting Phenomenon of Deep Click-Through Rate Prediction Models"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://zhuanlan.zhihu.com/p/669063912",children:"Ali's OneEpoch VS KuaiShou's MultiEpoch"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(6540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);